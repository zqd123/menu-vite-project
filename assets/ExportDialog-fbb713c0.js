import{b as w,E as g}from"./el-button-5f5c68ee.js";import{E as x}from"./el-dialog-47a213a0.js";import"./el-overlay-9bacb9c1.js";import{a as b,E}from"./el-tag-ab101870.js";import"./el-popper-8abbcb76.js";/* empty css                */import{u as D}from"./menuHook-8d729a2d.js";import{d as y,G as h,r as v,k,o as T,l as N,m,e as o,w as c,B as C,U as S,q as I}from"./index-d482fc19.js";import"./axios-656acb99.js";import"./event-53c52389.js";import"./_initCloneObject-ec564bd2.js";const q={class:"absolute left-0 bottom-0 z-[3000]"},B={class:"flex flex-col justify-center"},R=y({__name:"ExportDialog",setup(F){const{goLogin:_}=D();h(()=>{const t=sessionStorage.getItem("answer"),a=JSON.parse(t);r.value=u(a)});const r=v([]);function d(){const t=sessionStorage.getItem("answer"),a=JSON.parse(t);console.log("ğŸš€ ~ file: ExportDialog.vue:35 ~ exportExcel ~ answerData:",a),r.value=u(a),console.log("ğŸš€ ~ file: ExportDialog.vue:39 ~ exportExcel ~ mapData:",r.value),f(`åºå·,ä»»åŠ¡,é¢˜ç›®ç±»å‹,å›ç­”æ­£ç¡®,ä¼°è®¡èœå•æ•°é‡,ç”¨æ—¶(s)
`,r.value)}const f=(t,a)=>{for(let n=0;n<a.length;n++){for(const s in a[n])t+=`${a[n][s]+"	"},`;t+=`
`}const e="data:text/csv;charset=utf-8,\uFEFF"+encodeURIComponent(t),l=document.createElement("a");l.href=e,l.download=sessionStorage.userName??"export.csv",l.click()};function u(t){return t.map((e,l)=>{const{globDirection:n,isFirstShow:s,thirdDirection:p,num:i}=e.currentMenuTypeObj;return{index:l+1,questionType:e.questionType==="type1"?"ä»»åŠ¡1":e.questionType==="type2"?"ä»»åŠ¡2":"ä»»åŠ¡3",type:`${n==="row"?"æ¨ªå‘":"çºµå‘"}-${s?"1çº§éšè—":"1çº§å±•ç¤º"}-${p==="row"?"3çº§æ¨ªå‘":"3çº§çºµå‘"}-èœå•æ•°${i}`,answerValue:e.isAnswerTrue===!0?"æ­£ç¡®":e.isAnswerTrue===!1?"é”™è¯¯":"",guessNum:e.guessNum??"",time:e.times??""}})}return(t,a)=>{const e=k("House"),l=w,n=g,s=b,p=E,i=x;return T(),N(S,null,[m("div",q,[o(l,{color:"#79bbff",onClick:C(_)},{default:c(()=>[o(e)]),_:1},8,["onClick"])]),o(i,{"model-value":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,fullscreen:""},{default:c(()=>[m("div",B,[o(n,{type:"primary",onClick:d},{default:c(()=>[I(" å¯¼å‡ºæ•°æ® ")]),_:1}),o(p,{data:r.value,style:{width:"100%"}},{default:c(()=>[o(s,{prop:"index",label:"åºå·",width:"60"}),o(s,{prop:"questionType",label:"ä»»åŠ¡",width:"180"}),o(s,{prop:"type",label:"é¢˜ç›®ç±»å‹",width:"280"}),o(s,{prop:"answerValue",label:"å›ç­”æ­£ç¡®",width:"180"}),o(s,{prop:"guessNum",label:"ä¼°è®¡èœå•æ•°é‡"}),o(s,{prop:"time",label:"ç”¨æ—¶(s)"})]),_:1},8,["data"])])]),_:1})],64)}}});export{R as default};
