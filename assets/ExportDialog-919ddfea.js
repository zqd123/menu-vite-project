import{b as w,E as g}from"./el-button-00713da7.js";import{E as x}from"./el-dialog-2d164ffe.js";import"./el-overlay-eca0c3db.js";import{a as b,E}from"./el-tag-f0160561.js";import"./el-popper-3e301c43.js";import{u as D}from"./menuHook-fa747713.js";import{d as y,G as h,r as v,o as k,k as T,l as m,e as o,w as c,B as N,U as C,m as S,q as I}from"./index-f135e29b.js";import"./axios-a8b078e2.js";import"./index-23572607.js";import"./_initCloneObject-d8284a35.js";const q={class:"absolute left-0 bottom-0 z-[3000]"},B={class:"flex flex-col justify-center"},L=y({__name:"ExportDialog",setup(F){const{goLogin:_}=D();h(()=>{const t=sessionStorage.getItem("answer"),a=JSON.parse(t);r.value=u(a)});const r=v([]);function d(){const t=sessionStorage.getItem("answer"),a=JSON.parse(t);console.log("🚀 ~ file: ExportDialog.vue:35 ~ exportExcel ~ answerData:",a),r.value=u(a),console.log("🚀 ~ file: ExportDialog.vue:39 ~ exportExcel ~ mapData:",r.value),f(`序号,任务,题目类型,回答正确,估计菜单数量,用时(s)
`,r.value)}const f=(t,a)=>{for(let n=0;n<a.length;n++){for(const s in a[n])t+=`${a[n][s]+"	"},`;t+=`
`}const e="data:text/csv;charset=utf-8,\uFEFF"+encodeURIComponent(t),l=document.createElement("a");l.href=e,l.download=sessionStorage.userName??"export.csv",l.click()};function u(t){return t.map((e,l)=>{const{globDirection:n,isFirstShow:s,thirdDirection:p,num:i}=e.currentMenuTypeObj;return{index:l+1,questionType:e.questionType==="type1"?"任务1":e.questionType==="type2"?"任务2":"任务3",type:`${n==="row"?"横向":"纵向"}-${s?"1级隐藏":"1级展示"}-${p==="row"?"3级横向":"3级纵向"}-菜单数${i}`,answerValue:e.isAnswerTrue===!0?"正确":e.isAnswerTrue===!1?"错误":"",guessNum:e.guessNum??"",time:e.times??""}})}return(t,a)=>{const e=S("House"),l=w,n=g,s=b,p=E,i=x;return k(),T(C,null,[m("div",q,[o(l,{color:"#79bbff",onClick:N(_)},{default:c(()=>[o(e)]),_:1},8,["onClick"])]),o(i,{"model-value":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,fullscreen:""},{default:c(()=>[m("div",B,[o(n,{type:"primary",onClick:d},{default:c(()=>[I(" 导出数据 ")]),_:1}),o(p,{data:r.value,style:{width:"100%"}},{default:c(()=>[o(s,{prop:"index",label:"序号",width:"60"}),o(s,{prop:"questionType",label:"任务",width:"180"}),o(s,{prop:"type",label:"题目类型",width:"280"}),o(s,{prop:"answerValue",label:"回答正确",width:"180"}),o(s,{prop:"guessNum",label:"估计菜单数量"}),o(s,{prop:"time",label:"用时(s)"})]),_:1},8,["data"])])]),_:1})],64)}}});export{L as default};
