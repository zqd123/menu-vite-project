import{b as w,E as g}from"./el-button-c467b779.js";import{E as x}from"./el-dialog-eac09871.js";import"./el-overlay-5b8dc0df.js";import{a as b,E}from"./el-tag-114713d7.js";import"./el-popper-1dc0bd05.js";/* empty css                */import{u as D}from"./menuHook-66ad0a31.js";import{d as h,G as v,r as y,k,o as N,l as C,m,e,w as c,B as S,U as T,q as I}from"./index-8ec7d654.js";import"./axios-72013d42.js";import"./event-337f95ab.js";import"./_initCloneObject-9442602b.js";const B={class:"absolute left-0 bottom-0 z-[3000]"},F={class:"flex flex-col justify-center"},R=h({__name:"ExportDialog",setup(M){const{goLogin:_}=D();v(()=>{const o=sessionStorage.getItem("answer"),t=JSON.parse(o);r.value=u(t)});const r=y([]);function d(){const o=sessionStorage.getItem("answer"),t=JSON.parse(o);console.log("🚀 ~ file: ExportDialog.vue:35 ~ exportExcel ~ answerData:",t),r.value=u(t),console.log("🚀 ~ file: ExportDialog.vue:39 ~ exportExcel ~ mapData:",r.value),f(`序号,任务,题目类型,回答正确,估计数量,用时(s)
`,r.value)}const f=(o,t)=>{for(let s=0;s<t.length;s++){for(const n in t[s])o+=`${t[s][n]+"	"},`;o+=`
`}const a="data:text/csv;charset=utf-8,\uFEFF"+encodeURIComponent(o),l=document.createElement("a");l.href=a,l.download=sessionStorage.userName??"export.csv",l.click()};function u(o){return o.map((a,l)=>{const{globDirection:s,isFirstShow:n,thirdDirection:p,num:i}=a.currentMenuTypeObj;return{index:l+1,questionType:a.questionType??"",type:`${s}-${n}-${p}-${i}`,answerValue:a.isAnswerTrue??"",guessNum:a.guessNum??"",time:a.times??""}})}return(o,t)=>{const a=k("House"),l=w,s=g,n=b,p=E,i=x;return N(),C(T,null,[m("div",B,[e(l,{color:"#79bbff",onClick:S(_)},{default:c(()=>[e(a)]),_:1},8,["onClick"])]),e(i,{"model-value":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,fullscreen:""},{default:c(()=>[m("div",F,[e(s,{type:"primary",onClick:d},{default:c(()=>[I(" 导出数据 ")]),_:1}),e(p,{data:r.value,style:{width:"100%"}},{default:c(()=>[e(n,{prop:"index",label:"序号",width:"60"}),e(n,{prop:"questionType",label:"任务",width:"180"}),e(n,{prop:"type",label:"题目类型",width:"180"}),e(n,{prop:"answerValue",label:"回答正确",width:"180"}),e(n,{prop:"guessNum",label:"估计数量"}),e(n,{prop:"time",label:"用时(s)"})]),_:1},8,["data"])])]),_:1})],64)}}});export{R as default};
